import{_ as T,E as w}from"./index-2ca2b07e.js";import{a as v,f as C,e as E,aQ as g,T as L,U as N,a5 as a,$ as r,V as I,a3 as m}from"./vendor-a9dfa730.js";const $=""+new URL("../img/dog-1-cef428a6.jpg",import.meta.url).href,H=""+new URL("../img/dog-2-8994bc7d.jpg",import.meta.url).href,z=""+new URL("../img/dog-3-4a11c068.jpg",import.meta.url).href,W=""+new URL("../img/dog-4-179618cc.jpg",import.meta.url).href;const B={class:"dog"},M=["src"],A={__name:"dog",setup(O){var S={method:"GET",redirect:"follow"};const l=v(null),o=v(null),_=v("1"),V=C(()=>`https://gaoziyuan.oss-cn-beijing.aliyuncs.com/u148/dog-${_.value}.jpg`),x=(e,t="yyyy-mm-dd")=>{const n=new Date(e);if(isNaN(n.getTime()))throw new Error("Invalid date provided");const s=n.getFullYear(),d=n.getMonth()+1,i=n.getDate();return t.replace(/yyyy/g,s).replace(/yy/g,String(s).slice(-2)).replace(/mm/g,String(d).padStart(2,"0")).replace(/m/g,d).replace(/dd/g,String(i).padStart(2,"0")).replace(/d/g,i)},p=v(""),j=()=>{const e=x(new Date,"yyyy年mm月dd日");fetch("https://v2.xxapi.cn/api/dog",S).then(t=>t.text()).then(t=>{const n=JSON.parse(t);p.value=`${e},${n.data}`}).catch(t=>console.log("error",t))},k=()=>{if(!p.value){w.warning("请先获取文案或输入文案");return}const e=new Image;e.onload=function(){let d=30,i=0;const u=[],h=24;o.value.font=`${h}px Arial`;let c="";for(let f of p.value)o.value.measureText(c+f).width>680?(u.push(c),c=f):c+=f;c.length>0&&u.push(c);const R=e.width/e.height,b=340,y=b/R,U=y+20+u.length*28+30;l.value.width=340,l.value.height=U,o.value.clearRect(0,0,l.value.width,l.value.height),o.value.fillStyle="#ffffff",o.value.fillRect(0,0,l.value.width,l.value.height),o.value.drawImage(e,20,20,b,y),i=y+40,o.value.fillStyle="#000000";for(let f of u)o.value.fillText(f,d,i),i+=28;o.value.strokeStyle="#ebeef5",o.value.lineWidth=1,o.value.strokeRect(20,20,l.value.width-40,l.value.height-40),w.success("图片生成成功！"),D()},e.onerror=function(){w.error("图片加载失败，请检查网络连接")};const t={1:$,2:H,3:z,4:W};e.src=t[_.value]},D=()=>{if(!l.value)return;const e=document.createElement("a");e.download=`舔狗日记-${x(new Date,"yyyy-mm-dd")}.png`,e.href=l.value.toDataURL("image/png"),e.click()};return E(()=>{o.value=l.value.getContext("2d")}),(e,t)=>{const n=g("el-row"),s=g("el-radio"),d=g("el-radio-group"),i=g("el-input"),u=g("el-button"),h=g("el-space");return L(),N("div",B,[a(h,{direction:"vertical",size:"large"},{default:r(()=>[a(n,{type:"flex",justify:"center"},{default:r(()=>[I("img",{src:V.value,alt:"",class:"top-img"},null,8,M)]),_:1}),a(n,{type:"flex",justify:"center"},{default:r(()=>[a(d,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=c=>_.value=c)},{default:r(()=>[a(s,{value:"1",label:"舔狗男"},{default:r(()=>[m("舔狗男")]),_:1}),a(s,{value:"2",label:"舔狗女"},{default:r(()=>[m("舔狗女")]),_:1}),a(s,{value:"3",label:"记仇男"},{default:r(()=>[m("记仇男")]),_:1}),a(s,{value:"4",label:"记仇女"},{default:r(()=>[m("记仇女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(n,null,{default:r(()=>[a(i,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=c=>p.value=c),style:{width:"360px"},autosize:"",type:"textarea",placeholder:"Please input"},null,8,["modelValue"])]),_:1}),a(n,{type:"flex",justify:"center"},{default:r(()=>[a(u,{type:"primary",onClick:j},{default:r(()=>[m("随机文案")]),_:1}),a(u,{type:"primary",onClick:k},{default:r(()=>[m("生成图片")]),_:1})]),_:1})]),_:1}),I("canvas",{ref_key:"canvas",ref:l,width:"340"},null,512)])}}},G=T(A,[["__scopeId","data-v-54c85b9d"]]);export{G as default};
