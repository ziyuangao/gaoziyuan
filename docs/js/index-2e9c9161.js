import{m as L}from"./menuList-0b2c2318.js";import{o as g,p as b}from"./resources-6e3d64cc.js";import{a as s,e as T,a9 as A,T as p,U as m,a5 as E,V as I,I as U,ar as D,a2 as x,_ as M,u as $}from"./vendor-13527336.js";import{_ as O,a as N}from"./index-5c866205.js";function B(){const c=s("pc"),v=s(window.innerWidth),f=s(window.innerHeight),a=s(!1),l=s(!1),n=s(!0),o=()=>{v.value=window.innerWidth,f.value=window.innerHeight,v.value<768?(c.value="mobile",a.value=!0,l.value=!1,n.value=!1):v.value>=768&&v.value<=1024?(c.value="tablet",a.value=!1,l.value=!0,n.value=!1):(c.value="pc",a.value=!1,l.value=!1,n.value=!0)},u=()=>{const i=navigator.userAgent.toLowerCase(),_=/mobile|android|iphone|ipod|windows phone|blackberry|webos|opera mini|iemobile/.test(i);/ipad|tablet|kindle|silk/.test(i)?(c.value="tablet",a.value=!1,l.value=!0,n.value=!1):_&&(c.value="mobile",a.value=!0,l.value=!1,n.value=!1)},d=()=>{o()};return T(()=>{u(),o(),window.addEventListener("resize",d)}),A(()=>{window.removeEventListener("resize",d)}),{deviceType:c,screenWidth:v,screenHeight:f,isMobile:a,isTablet:l,isPC:n}}const P={class:"page"},z={class:"photo-wall"},C={key:0,class:"loading-tip"},R={key:1,class:"no-more-tip"},V=296,w=10,W=100,F=3,j={__name:"index",setup(c){const{screenWidth:v}=B(),f=v.value<768?100:350,a=s([]),l=s([]),n=s(0),o=s(!1),u=s(!1),d=s(null),i=s(null),_=()=>{const e=[];for(let t=0;t<V;t++)e.push({id:t+1,thumbnail:`${g}${b}${t+1}.jpg?x-oss-process=image/resize,w_${f},h_${f},m_fill`,url:`${g}${b}${t+1}.jpg`});a.value=e.reverse()},h=()=>{if(o.value||u.value)return!1;const e=n.value*w;if(e>=a.value.length)return u.value=!0,!1;o.value=!0;const t=Math.min(e+w,a.value.length),r=a.value.slice(e,t);return l.value.push(...r),n.value++,o.value=!1,n.value*w>=a.value.length&&(u.value=!0),!0},k=()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return e>=t},y=()=>{i.value&&i.value.disconnect(),i.value=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&!o.value&&!u.value&&h()})},{root:null,rootMargin:`${W}px`,threshold:.1}),d.value&&i.value.observe(d.value)},H=async()=>{_(),h(),await new Promise(r=>setTimeout(r,100));let e=0;const t=F;for(;e<t&&!k()&&!u.value;)o.value||(h(),e++,await new Promise(r=>setTimeout(r,150)));y()};return T(()=>{H()}),A(()=>{i.value&&i.value.disconnect()}),(e,t)=>(p(),m("div",P,[E(L),I("div",z,[(p(!0),m(U,null,D(l.value,r=>(p(),M($(N),{key:r.id,class:"photo-item",src:r.thumbnail,fit:"cover","preview-src-list":[r.url],loading:"lazy","hide-on-click-modal":""},null,8,["src","preview-src-list"]))),128)),o.value?(p(),m("div",C,"正在加载中...")):x("",!0),u.value?(p(),m("div",R,"已经到底了")):x("",!0)]),I("div",{ref_key:"sentinelRef",ref:d,class:"sentinel"},null,512)]))}},J=O(j,[["__scopeId","data-v-09bf2e96"]]);export{J as default};
