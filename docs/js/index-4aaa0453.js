import{o as g,p as b}from"./resources-6e3d64cc.js";import{a as s,e as A,a9 as k,T as h,U as _,V as I,I as x,ar as L,a2 as T,_ as U,u as D}from"./vendor-13527336.js";import{_ as M,a as $}from"./index-9c92b344.js";function O(){const c=s("pc"),v=s(window.innerWidth),f=s(window.innerHeight),a=s(!1),n=s(!1),l=s(!0),o=()=>{v.value=window.innerWidth,f.value=window.innerHeight,v.value<768?(c.value="mobile",a.value=!0,n.value=!1,l.value=!1):v.value>=768&&v.value<=1024?(c.value="tablet",a.value=!1,n.value=!0,l.value=!1):(c.value="pc",a.value=!1,n.value=!1,l.value=!0)},u=()=>{const i=navigator.userAgent.toLowerCase(),m=/mobile|android|iphone|ipod|windows phone|blackberry|webos|opera mini|iemobile/.test(i);/ipad|tablet|kindle|silk/.test(i)?(c.value="tablet",a.value=!1,n.value=!0,l.value=!1):m&&(c.value="mobile",a.value=!0,n.value=!1,l.value=!1)},d=()=>{o()};return A(()=>{u(),o(),window.addEventListener("resize",d)}),k(()=>{window.removeEventListener("resize",d)}),{deviceType:c,screenWidth:v,screenHeight:f,isMobile:a,isTablet:n,isPC:l}}const B={class:"photo-wall"},N={key:0,class:"loading-tip"},P={key:1,class:"no-more-tip"},z=296,w=10,C=100,R=3,V={__name:"index",setup(c){const{screenWidth:v}=O(),f=v.value<768?100:350,a=s([]),n=s([]),l=s(0),o=s(!1),u=s(!1),d=s(null),i=s(null),m=()=>{const e=[];for(let t=0;t<z;t++)e.push({id:t+1,thumbnail:`${g}${b}${t+1}.jpg?x-oss-process=image/resize,w_${f},h_${f},m_fill`,url:`${g}${b}${t+1}.jpg`});a.value=e.reverse()},p=()=>{if(o.value||u.value)return!1;const e=l.value*w;if(e>=a.value.length)return u.value=!0,!1;o.value=!0;const t=Math.min(e+w,a.value.length),r=a.value.slice(e,t);return n.value.push(...r),l.value++,o.value=!1,l.value*w>=a.value.length&&(u.value=!0),!0},y=()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return e>=t},H=()=>{i.value&&i.value.disconnect(),i.value=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&!o.value&&!u.value&&p()})},{root:null,rootMargin:`${C}px`,threshold:.1}),d.value&&i.value.observe(d.value)},E=async()=>{m(),p(),await new Promise(r=>setTimeout(r,100));let e=0;const t=R;for(;e<t&&!y()&&!u.value;)o.value||(p(),e++,await new Promise(r=>setTimeout(r,150)));H()};return A(()=>{E()}),k(()=>{i.value&&i.value.disconnect()}),(e,t)=>(h(),_(x,null,[I("div",B,[(h(!0),_(x,null,L(n.value,r=>(h(),U(D($),{key:r.id,class:"photo-item",src:r.thumbnail,fit:"cover","preview-src-list":[r.url],loading:"lazy","hide-on-click-modal":""},null,8,["src","preview-src-list"]))),128)),o.value?(h(),_("div",N," 正在加载中... ")):T("",!0),u.value?(h(),_("div",P," 已经到底了 ")):T("",!0)]),I("div",{ref_key:"sentinelRef",ref:d,class:"sentinel"},null,512)],64))}},G=M(V,[["__scopeId","data-v-992d7e4a"]]);export{G as default};
