import{m as L}from"./menuList-CUT9PFoG.js";import{o as g,p as b}from"./resources-CQeFrP1H.js";import{r as s,m as E,a6 as H,G as p,E as h,H as D,J as I,Z as A,a1 as y,al as M,D as O,u as U}from"./vendor-DGMjvXeI.js";import{_ as $,E as N}from"./index-BuCwV4Ff.js";function P(){const c=s("pc"),v=s(window.innerWidth),f=s(window.innerHeight),a=s(!1),o=s(!1),l=s(!0),n=()=>{v.value=window.innerWidth,f.value=window.innerHeight,v.value<768?(c.value="mobile",a.value=!0,o.value=!1,l.value=!1):v.value>=768&&v.value<=1024?(c.value="tablet",a.value=!1,o.value=!0,l.value=!1):(c.value="pc",a.value=!1,o.value=!1,l.value=!0)},u=()=>{const i=navigator.userAgent.toLowerCase(),w=/mobile|android|iphone|ipod|windows phone|blackberry|webos|opera mini|iemobile/.test(i);/ipad|tablet|kindle|silk/.test(i)?(c.value="tablet",a.value=!1,o.value=!0,l.value=!1):w&&(c.value="mobile",a.value=!0,o.value=!1,l.value=!1)},d=()=>{n()};return E(()=>{u(),n(),window.addEventListener("resize",d)}),H(()=>{window.removeEventListener("resize",d)}),{deviceType:c,screenWidth:v,screenHeight:f,isMobile:a,isTablet:o,isPC:l}}const B={class:"page"},z={class:"photo-wall"},C={key:0,class:"loading-tip"},R={key:1,class:"no-more-tip"},W=296,_=10,V=100,j=3,F=Object.assign({name:"PhotoWall"},{__name:"index",setup(c){const{screenWidth:v}=P(),f=v.value<768?100:350,a=s([]),o=s([]),l=s(0),n=s(!1),u=s(!1),d=s(null),i=s(null),w=()=>{const e=[];for(let t=0;t<W;t++)e.push({id:t+1,thumbnail:`${g}${b}${t+1}.jpg?x-oss-process=image/resize,w_${f},h_${f},m_fill`,url:`${g}${b}${t+1}.jpg`});a.value=e.reverse()},m=()=>{if(n.value||u.value)return!1;const e=l.value*_;if(e>=a.value.length)return u.value=!0,!1;n.value=!0;const t=Math.min(e+_,a.value.length),r=a.value.slice(e,t);return o.value.push(...r),l.value++,n.value=!1,l.value*_>=a.value.length&&(u.value=!0),!0},T=()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return e>=t},k=()=>{i.value&&i.value.disconnect(),i.value=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&!n.value&&!u.value&&m()})},{root:null,rootMargin:`${V}px`,threshold:.1}),d.value&&i.value.observe(d.value)},x=async()=>{w(),m(),await new Promise(r=>setTimeout(r,100));let e=0;const t=j;for(;e<t&&!T()&&!u.value;)n.value||(m(),e++,await new Promise(r=>setTimeout(r,150)));k()};return E(()=>{x()}),H(()=>{i.value&&i.value.disconnect()}),(e,t)=>(h(),p("div",B,[D(L),I("div",z,[(h(!0),p(y,null,M(o.value,r=>(h(),O(U(N),{key:r.id,class:"photo-item",src:r.thumbnail,fit:"cover","preview-src-list":[r.url],loading:"lazy","hide-on-click-modal":""},null,8,["src","preview-src-list"]))),128)),n.value?(h(),p("div",C,"正在加载中...")):A("",!0),u.value?(h(),p("div",R,"已经到底了")):A("",!0)]),I("div",{ref_key:"sentinelRef",ref:d,class:"sentinel"},null,512)]))}}),Z=$(F,[["__scopeId","data-v-a4a2b304"]]);export{Z as default};
